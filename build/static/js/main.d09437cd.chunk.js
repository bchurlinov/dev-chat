(this["webpackJsonpchat-app"]=this["webpackJsonpchat-app"]||[]).push([[0],{135:function(e,a,t){},171:function(e,a,t){},193:function(e,a,t){e.exports=t(351)},202:function(e,a,t){},272:function(e,a,t){},324:function(e,a,t){},332:function(e,a,t){},333:function(e,a,t){},334:function(e,a,t){},335:function(e,a,t){},336:function(e,a,t){},344:function(e,a,t){},345:function(e,a,t){},346:function(e,a,t){},347:function(e,a,t){},351:function(e,a,t){"use strict";t.r(a);var n=t(48),r=t(49),c=t(53),l=t(50),s=t(54),i=t(0),o=t.n(i),u=t(4),m=t.n(u),d=t(367),p=t(355),h=t(365),f=t(366),g=t(364),E=t(22),b=function(e){return{type:"SET_CURRENT_CHANNEL",payload:{currentChannel:e}}},v=function(e){return{type:"SET_CHANNEL_TYPE",payload:e}},y=(t(202),t(3)),j=t(10),O=t(356),C=t(7),N=t(361),S=t(27),w=t(363),U=t(360),k=t(359),T=t(29),_=t(138),A=t.n(_);t(266),t(268),t(352);A.a.initializeApp({apiKey:"AIzaSyCcr13AZkolsXAV96UM1XRIy4w1wB7kIq0",authDomain:"bojan-b3887.firebaseapp.com",databaseURL:"https://bojan-b3887.firebaseio.com",projectId:"bojan-b3887",storageBucket:"bojan-b3887.appspot.com",messagingSenderId:"112203988888",appId:"1:112203988888:web:5ceadf01c7b3d93c3a75ed"});var V=A.a,x=(t(272),{heading:{marginBottom:0,fontSize:"18px",textAlign:"center"},icon:{marginRight:"5px",fontSize:"20px",position:"relative",top:"1px",display:"inline-block"}}),M=function(e){var a=e.user,t=e.isVisible,n=e.toggleModal,r=Object(i.useState)({name:"",email:""}),c=Object(j.a)(r,2),l=c[0],s=c[1],u=function(e){s(Object(y.a)({},l,Object(S.a)({},e.target.name,e.target.value)))},m=function(){w.a.success("Channel created successfully",2)},d=function(){return h()?!!p()||(console.log("email invalid"),!1):(console.log("name invalid"),!1)},p=function(){return!(!l.email.match(/\S+@\S+\.\S+/)&&""!==l.email)},h=function(){return!(""===l.name||l.name.length<2)};return console.log(a),o.a.createElement("div",null,o.a.createElement(U.a,{title:o.a.createElement("h3",{style:x.heading},o.a.createElement(C.a,{type:"user","data-type":"channel",style:x.icon})," Edit user"),visible:t,footer:null,onCancel:n},o.a.createElement("div",{className:"editUserCard"},o.a.createElement("div",{className:"editUserCard__photo"},o.a.createElement("img",{src:a.photoURL,alt:"Dev Chat User Image"})),o.a.createElement("div",{className:"editUserCard__user"},o.a.createElement("form",{onSubmit:function(e){e.preventDefault(),d()&&(m(),setTimeout((function(){n()}),1750),a.updateProfile({displayName:l.name}).then((function(){a.updateEmail(l.email?l.email:a.email)})).then((function(){V.database().ref("users").child(a.uid).update({user:a.displayName,avatar:a.photoURL,id:a.uid})})))},noValidate:!0},o.a.createElement("div",{className:"form-group"},o.a.createElement("label",null,"Name:"),o.a.createElement(k.a,{name:"name",type:"text",onChange:u,placeholder:a&&a.displayName})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",null,"Email:"),o.a.createElement(k.a,{name:"email",type:"email",onChange:u,placeholder:a&&a.email})),o.a.createElement("div",{style:{textAlign:"center"}},o.a.createElement(T.a,{type:"primary",htmlType:"submit"},"Submit changes")))))))},D=(t(324),function(e){var a=e.user,t=Object(i.useState)({isVisible:!1}),n=Object(j.a)(t,2),r=n[0],c=n[1],l=function(){c(Object(y.a)({},r,{isVisible:!r.isVisible}))},s=o.a.createElement(O.a,null,o.a.createElement(O.a.Item,{className:"user-panel-menu-item"},o.a.createElement("a",{onClick:l,href:"# "},o.a.createElement(C.a,{type:"edit"})," Edit User")),o.a.createElement(O.a.Item,{className:"user-panel-menu-item"},o.a.createElement("a",{onClick:function(){V.auth().signOut().then((function(){V.database().ref("presence").child(a.uid).remove()}))},href:"# "},o.a.createElement(C.a,{type:"import"})," Log Out")));return o.a.createElement("div",{className:"user-panel"},o.a.createElement(N.a,{overlay:s},o.a.createElement("a",{className:"ant-dropdown-link",href:"# "},o.a.createElement("img",{src:a&&a.photoURL,alt:"Dev Chat Image"})," Welcome, ",o.a.createElement("span",null,a&&a.displayName)," ",o.a.createElement(C.a,{type:"down"}))),o.a.createElement(M,{user:a,isVisible:r.isVisible,toggleModal:function(){return l()}}))});D.defaultProps={displayName:"User"};var L=D,R=t(9),P=t.n(R),I=(t(332),Object(E.b)(null,(function(e){return{setCurrentChannel:function(a){return e(b(a))},setChannelType:function(a){return e(v(a))}}}))((function(e){var a=e.user,t=e.channel,n=Object(i.useState)({users:[]}),r=Object(j.a)(n,2),c=r[0],l=r[1];Object(i.useEffect)((function(){var e=[],t=V.database().ref("users");t.on("child_added",(function(t){if(t&&a.uid!==t.val().id){console.log(t.val());var n={avatar:t.val().avatar,id:t.val().id,user:t.val().user,status:"offline"};e.push(n),l(Object(y.a)({},c,{users:e}))}}));return V.database().ref(".info/connected").on("value",(function(e){if(!0===e.val()){var t=V.database().ref("presence").child(a.uid);t.set(!0),t.onDisconnect().remove()}})),V.database().ref("presence").on("child_added",(function(t){t.key!==a.uid&&s(t.key,!0,e)})),V.database().ref("presence").on("child_removed",(function(t){t.key!==a.uid&&s(t.key,!1,e)})),function(){return t.off()}}),[]);var s=function(e,a,t){var n=P.a.reduce(t,(function(t,n){return n.id===e&&(n.status="".concat(a?"online":"offline")),t.concat(n)}),[]);l(Object(y.a)({},c,{users:n}))},u=function(e){if(t)return P.a.includes(t.id,e.id)?"active-user":""},m=function(t){var n={avatar:t.avatar,name:t.user,id:t.id<a.uid?"".concat(t.id,"-").concat(a.uid):"".concat(a.uid,"-").concat(t.id)};e.setCurrentChannel(n),e.setChannelType("private")};return o.a.createElement("div",{className:"direct-messages"},o.a.createElement("h3",null,o.a.createElement(C.a,{type:"mail"}),"Direct Messages "," ","( ",o.a.createElement("b",null," ",function(){if(c&&0!==c.users.length)return c.users.length}()," ")," )"),o.a.createElement("ul",null,function(e){if(e)return P.a.map(e,(function(e,a){return o.a.createElement("li",{key:a,onClick:function(){return m(e)},className:u(e)},function(e){var a=null;return"online"===e.status?a=o.a.createElement("span",{style:{background:"#66ff66"}}):"offline"===e.status&&(a=o.a.createElement("span",{style:{background:"#ff3232"}})),a}(e)," ",e.user)}))}(c.users)))}))),B=(t(135),function(e){var a=e.modalVisibility,t=e.clicked,n=e.addChannel,r=Object(i.useState)({name:"",description:""}),c=Object(j.a)(r,2),l=c[0],s=c[1],u=Object(i.useState)({errMessage:[]}),m=Object(j.a)(u,2),d=m[0],p=m[1],h={heading:{marginBottom:0,fontSize:"18px",textAlign:"center"},icon:{marginRight:"10px",fontSize:"20px",position:"relative",top:"1px",display:"inline-block"}},f=function(e){s(Object(y.a)({},l,Object(S.a)({},e.target.name,e.target.value)))},g=function(){return!!E()&&(!!b()&&(p(Object(y.a)({},d,{errMessage:[]})),!0))},E=function(){var e="",a=[];return 0===l.name.length?(e="Channel name field can't be empty",p(Object(y.a)({},d,{errMessage:a.concat(e)})),!1):l.name.length<2?(e="Channel name field should contain at least 2 letters",p(Object(y.a)({},d,{errMessage:a.concat(e)})),!1):!!l.name.match(/^[a-zA-Z]+$/)||(e="Channel name field shouldn't contain numbers or special characters",p(Object(y.a)({},d,{errMessage:a.concat(e)})),!1)},b=function(){var e="",a=[];return 0===l.description.length?(e="Channel description field can't be empty",p(Object(y.a)({},d,{errMessage:a.concat(e)})),!1):!(l.description.length<10)||(e="Channel description should contain at least 10 letters",p(Object(y.a)({},d,{errMessage:a.concat(e)})),!1)},v=function(e){return P.a.some(d.errMessage,(function(a){return a.toLowerCase().includes(e)}))?"not-valid":"valid"};return o.a.createElement("div",null,o.a.createElement(U.a,{title:o.a.createElement("h3",{style:h.heading},o.a.createElement(C.a,{type:"interaction","data-type":"channel",style:h.icon})," Add a channel"),visible:a,onOk:n,onCancel:t,footer:null},o.a.createElement("div",{className:"channel-modal"},o.a.createElement("form",{onSubmit:function(e){e.preventDefault(),g()&&(n(l),s(Object(y.a)({},l,{name:"",description:""})),setTimeout((function(){t()}),1750))}},o.a.createElement("div",{className:"form-group"},o.a.createElement("label",null,"Add channel name: "),o.a.createElement(k.a,{onChange:f,className:v("name"),value:l.name,name:"name"})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",null,"Add channel description: "),o.a.createElement(k.a.TextArea,{onChange:f,className:v("description"),value:l.description,name:"description",rows:4})),o.a.createElement("div",{className:"render-channel-errors"},P.a.map(d.errMessage,(function(e,a){return o.a.createElement("p",{key:a},e)}))),o.a.createElement("div",{className:"form-group",style:{textAlign:"center"}},o.a.createElement(T.a,{type:"primary",htmlType:"submit"},o.a.createElement(C.a,{type:"plus-circle"}),"Add Channel"))))))}),z=Object(E.b)(null,(function(e){return{setCurrentChannel:function(a){return e(b(a))},setChannelType:function(a){return e(v(a))}}}))((function(e){var a=e.sendChannels,t=e.setCurrentChannel,n=e.setChannelType,r=e.currentChannel,c=function(e){if(r&&r.id===e.id)return"active-channel"},l=function(e){t(e),n("public")};return o.a.createElement("div",{className:"display-channels"},o.a.createElement("ul",null,a&&P.a.map(a.updatedChannels,(function(e,a){return o.a.createElement("li",{key:a,onClick:function(){return l(e)},className:c(e)},o.a.createElement("span",null,"#")," ",e.name)}))))})),F=Object(E.b)(null,(function(e){return{setCurrentChannel:function(a){return e(b(a))},setChannelType:function(a){return e(v(a))}}}))((function(e){var a=e.user,t=e.currentChannel,n=e.setCurrentChannel,r=e.setChannelType,c=Object(i.useState)({isVisible:!1}),l=Object(j.a)(c,2),s=l[0],u=l[1],m=function(){w.a.success("Channel successfully created",2)},d=function(){u(Object(y.a)({},s,{isVisible:!s.isVisible}))},p=Object(i.useState)({updatedChannels:[]}),h=Object(j.a)(p,2),f=h[0],g=h[1];Object(i.useEffect)((function(){var e=[],a=V.database().ref("channels");return a.on("child_added",(function(a){var t=a.val();e.push(t),g(Object(y.a)({},f,{updatedChannels:e})),E(e)})),function(){return a.off()}}),[]);var E=function(e){var a=e[0];void 0!==a&&(n(a),r("public"))};return o.a.createElement("div",{className:"channels"},o.a.createElement("h3",null,o.a.createElement(C.a,{type:"interaction","data-type":"channel"})," Channels",o.a.createElement("span",{onClick:d},o.a.createElement(C.a,{type:"plus-circle"}))),o.a.createElement(B,{modalVisibility:s.isVisible,addChannel:function(e){return function(e){var t=e.name,n=e.description,r=V.database().ref("channels"),c=r.push().key,l={name:t,details:n,id:c,createdBy:{name:a.displayName,avatar:a.photoURL}};m(),setTimeout((function(){u(Object(y.a)({},s,{isVisible:!1}))}),1750),r.child(c).update(l).then((function(e){console.log("Channel Added")}))}(e)},clicked:d}),o.a.createElement(z,{sendChannels:f,currentChannel:t,key:f}))})),H=(t(333),function(e){function a(){var e,t;Object(n.a)(this,a);for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return(t=Object(c.a)(this,(e=Object(l.a)(a)).call.apply(e,[this].concat(s)))).state={user:t.props.user},t}return Object(s.a)(a,e),Object(r.a)(a,[{key:"render",value:function(){return o.a.createElement("div",{className:"chat-wrapper__item"},o.a.createElement("div",{className:"side-panel-logo"},o.a.createElement("h1",null,o.a.createElement(C.a,{type:"wechat"})," Dev",o.a.createElement("span",null,"Chat"))),o.a.createElement(L,{user:this.state.user}),o.a.createElement(F,{user:this.state.user,currentChannel:this.props.currentChannel}),o.a.createElement(I,{user:this.state.user,channel:this.props.currentChannel}))}}]),a}(i.Component)),q=Object(E.b)((function(e){return{currentChannel:e.channel.currentChannel}}),null)(H),K=t(190),W=(t(334),function(e){var a=e.channel,t=e.user,n=e.sendTyping,r=Object(i.useState)({typing:[]}),c=Object(j.a)(r,2),l=c[0],s=c[1];Object(i.useEffect)((function(){if(a){var e=[],n=V.database().ref("isTyping").child(a.id);return n.on("child_added",(function(a){a.key!==t.uid&&(e=e.concat({id:a.key,name:a.val()}),s(Object(y.a)({},l,{typing:e})))})),n.on("child_removed",(function(a){P.a.includes(e,t.id===a.key)||(e=P.a.filter(e,(function(e){return e.id!==a.key})),s(Object(y.a)({},l,{typing:e})))})),V.database().ref(".info/connected").on("value",(function(e){!0===e.val()&&V.database().ref("isTyping").child(a.id).child(t.uid).onDisconnect().remove()})),function(){return n.off()}}}),[n.length]);return o.a.createElement("div",{className:"isTyping-container"},function(){if(l.typing)return P.a.map(l.typing,(function(e,a){return o.a.createElement("p",{key:a},o.a.createElement("b",null,e.name)," ",o.a.createElement("span",null,"is typing")," ",o.a.createElement(o.a.Fragment,null,o.a.createElement("span",{className:"dot"}),o.a.createElement("span",{className:"dot"}),o.a.createElement("span",{className:"dot"})))}))}())}),Y=(t(335),k.a.Search),J=function(e){var a=e.channel,t=e.loader,n=e.messages,r=e.channelType;return o.a.createElement("div",{className:"message-header"},o.a.createElement("div",{className:"message-header__item"},o.a.createElement("h3",null,function(){var e=null;return"private"===r?e=o.a.createElement(C.a,{type:"user"}):"public"===r&&(e=o.a.createElement(C.a,{type:"number"})),e}(),a&&a.name," ",o.a.createElement("span",null,"( ",function(){var e=[];P.a.map(n,(function(a,t){e.push(a.user.name)}));return P.a.uniqBy(e).length}()," users )"))),o.a.createElement("div",{className:"message-header__item"},o.a.createElement(Y,{placeholder:"Search messages...",onChange:function(a){return e.search(a)},onKeyUp:function(){return e.filtered()},loading:t,style:{width:200}})))},X=t(184),Z=t.n(X),$=(t(336),function(e){var a=e.messages;e.channel;Object(i.useLayoutEffect)((function(){var e=document.getElementById("render-messages-container");e.scrollTo(0,e.scrollHeight)}),[a.length]);var t;return o.a.createElement("div",{className:"render-messages",id:"render-messages-container"},o.a.createElement("div",{className:"render-messages-wrapper"},(t=a)&&P.a.map(t,(function(e,a){return o.a.createElement("div",{className:"render-messages-wrapper__item",key:a},o.a.createElement("div",null,o.a.createElement("img",{src:e.user.avatar,alt:"Dev Chat Image"})),o.a.createElement("div",null,o.a.createElement("p",null,o.a.createElement("b",null,e.user.name),o.a.createElement("span",null,"( ",Z()(e.timestamp).fromNow()," )")),function(e){return e.hasOwnProperty("content")?o.a.createElement("p",null,e.content):e.hasOwnProperty("image")?o.a.createElement("img",{src:e.image,style:{width:"100%",height:"350px",objectFit:"cover"},alt:"Dev Chat Image"}):void 0}(e)))}))))}),G=t(189),Q=(t(338),t(357)),ee=t(185),ae=t.n(ee),te=function(e){function a(){var e,t;Object(n.a)(this,a);for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return(t=Object(c.a)(this,(e=Object(l.a)(a)).call.apply(e,[this].concat(s)))).state={isUploading:!1,progress:0,imageUrl:""},t.handleUploadStart=function(){t.setState({isUploading:!0,progress:0})},t.handleProgress=function(e){t.setState({progress:e})},t.handleUploadError=function(e){t.setState({isUploading:!1})},t.handleUploadSuccess=function(e){t.setState({progress:100,isUploading:!1}),V.storage().ref("images").child(e).getDownloadURL().then((function(e){t.props.imageData(e)}))},t}return Object(s.a)(a,e),Object(r.a)(a,[{key:"render",value:function(){return o.a.createElement("div",{className:"file-uploader"},o.a.createElement(ae.a,{accept:"image/*",name:"chat-image",randomizeFilename:!0,storageRef:V.storage().ref("images"),onUploadStart:this.handleUploadStart,onUploadError:this.handleUploadError,onUploadSuccess:this.handleUploadSuccess,onProgress:this.handleProgress}),o.a.createElement("div",{style:{marginTop:"15px"}},this.state.isUploading?o.a.createElement("div",null,"Progress:  ",o.a.createElement(Q.a,{percent:this.state.isUploading&&this.state.progress})," "):null))}}]),a}(i.Component),ne=(t(344),function(e){var a=e.channel,t=e.user,n=e.typing,r=Object(i.useState)({message:""}),c=Object(j.a)(r,2),l=c[0],s=c[1],u=Object(i.useState)({isVisible:!1}),m=Object(j.a)(u,2),d=m[0],p=m[1],h=Object(i.useState)({isVisible:!1}),f=Object(j.a)(h,2),g=f[0],E=f[1],b=function(){p(Object(y.a)({},d,{isVisible:!d.isVisible}))},v=function(e){e.preventDefault();var n={content:l.message,timestamp:V.database.ServerValue.TIMESTAMP,user:{avatar:t.photoURL,name:t.displayName,id:t.uid}};O()&&(V.database().ref("messages").child(a.id).push().set(n),V.database().ref("notifications").child(a.id).update({user:{name:t.displayName,id:t.uid}}),s(Object(y.a)({},l,{message:""})))},O=function(){return l.message.length>0||(N(),!1)},N=function(){w.a.error("New message can't be empty")},_=function(e){s(Object(y.a)({},l,{message:l.message.concat(e.native)})),E(Object(y.a)({},g,{isVisible:!g.isVisible}))};return o.a.createElement("div",{className:"message-form"},o.a.createElement("form",{onSubmit:v},o.a.createElement("div",{className:"message-form__item"},o.a.createElement("div",{className:"send-message-wrap"},o.a.createElement("button",{onClick:function(e){return function(e){e.preventDefault(),E(Object(y.a)({},g,{isVisible:!g.isVisible}))}(e)},className:g.isVisible?"emoji-button-clicked":""},o.a.createElement(C.a,{type:"plus"})),o.a.createElement(k.a,{placeholder:"Enter new message",autoComplete:"off",name:"message",type:"text",value:l.message,onChange:function(e){s(Object(y.a)({},l,Object(S.a)({},e.target.name,e.target.value)))},onKeyDown:function(e){13===e.keyCode&&v(e)},onKeyUp:function(e){n(e.target.value),l.message?V.database().ref("isTyping").child(a.id).child(t.uid).set(t.displayName):V.database().ref("isTyping").child(a.id).child(t.uid).remove()}}))),o.a.createElement("div",{className:"message-form__item"},o.a.createElement(T.a,{type:"primary",htmlType:"submit"},o.a.createElement(C.a,{type:"mail"})," Send Message"),o.a.createElement(T.a,{type:"primary",onClick:b},o.a.createElement(C.a,{type:"file-image"})," Upload an Image")),g.isVisible?o.a.createElement(G.a,{set:"apple",style:{position:"absolute",bottom:"115px",left:"25px",zIndex:"999"},title:"Pick your emoji",emoji:"point_up",onSelect:_}):null),o.a.createElement(U.a,{title:"Upload an image",visible:d.isVisible,onOk:function(){return b()},okText:"Done Uploading",onCancel:function(){return b()}},o.a.createElement(te,{imageData:function(e){return function(e){var n={image:e,timestamp:V.database.ServerValue.TIMESTAMP,user:{avatar:t.photoURL,name:t.displayName,id:t.uid}};V.database().ref("messages").child(a.id).push().set(n)}(e)}})))}),re=(t(345),Object(E.b)(null,null)((function(e){var a=e.channel,t=e.user,n=e.channelType,r=Object(i.useState)({updatedMessages:[]}),c=Object(j.a)(r,2),l=c[0],s=c[1],u=Object(i.useState)({messages:[]}),m=Object(j.a)(u,2),d=m[0],p=m[1],h=Object(i.useState)({value:""}),f=Object(j.a)(h,2),g=f[0],E=f[1],b=Object(i.useState)({loading:!1}),v=Object(j.a)(b,2),O=v[0],C=v[1];Object(i.useEffect)((function(){if(a){var e=[],t=V.database().ref("messages").child(a.id);t.on("child_added",(function(a){var t=a.val();e.push(t),s(Object(y.a)({},l,{updatedMessages:e}))}));return function(){return t.off()}}}),[]);var N=Object(i.useState)({typing:""}),S=Object(j.a)(N,2),w=S[0],U=S[1];return o.a.createElement("div",{className:"chat-wrapper__item"},o.a.createElement(J,{channel:a,channelUsers:function(){var e=void 0!==l&&l.updatedMessages,a=P.a.reduce(e,(function(e,a){return e.concat(a.sender)}),[]);return P.a.uniqBy(a).length}(),search:function(e){return function(e){E(Object(y.a)({},g,{value:e.target.value}))}(e)},messages:l.updatedMessages,filtered:function e(){var a=new RegExp(g.value,"gi"),t=Object(K.a)(l.updatedMessages);g.value.length>0&&C(Object(y.a)({},O,{loading:!0}));var n=P.a.reduce(t,(function(e,t){return(t.content&&t.content.match(a)||t.user.name&&t.user.name.match(a))&&e.push(t),e}),[]);setTimeout((function(){C(Object(y.a)({},O,{loading:!1}))}),1e3),p(Object(y.a)({},e,{messages:n}))},loader:O.loading,channelType:n}),o.a.createElement($,{messages:g.value.length>0?d.messages:l.updatedMessages,channel:a}),o.a.createElement(W,{channel:a,user:t,sendTyping:w.typing}),o.a.createElement(ne,{channel:a,user:t,typing:function(e){return function(e){U(Object(y.a)({},w,{typing:e}))}(e)}}))}))),ce=t(358),le=(t(346),ce.a.Panel),se=function(e){e.user;var a=e.channel,t=e.channelType,n=Object(i.useState)([]),r=Object(j.a)(n,2),c=r[0],l=r[1];Object(i.useEffect)((function(){if(a){var e=[];V.database().ref("messages").child(a.id).on("child_added",(function(a){e.push(a.val());var t=P.a.reduce(e,(function(e,a){return e.concat(a.user.name)}),[]),n=P.a.values(P.a.groupBy(t)).map((function(e){return{name:e[0],count:e.length}})),r=P.a.orderBy(n,["count"],["desc"]);l(Object(y.a)({},c,{sorted:r}))}))}}),[a]);var s=function(e){var a=null;return"private"===e?a=o.a.createElement(C.a,{type:"user"}):"public"===e&&(a=o.a.createElement(C.a,{type:"number"})),a};return o.a.createElement("div",{className:"chat-wrapper__item"},function(){var e=null;return a&&"public"===t&&(e=o.a.createElement("div",{className:"channel-info-wrap"},o.a.createElement("div",null,o.a.createElement("h3",null,s(t)," ",a.name)),o.a.createElement("div",null,o.a.createElement(ce.a,null,o.a.createElement(le,{header:o.a.createElement("span",null,o.a.createElement(C.a,{type:"info-circle"})," Channel Details"),key:"1"},o.a.createElement("p",null,a.details)),o.a.createElement(le,{header:o.a.createElement("span",null,o.a.createElement(C.a,{type:"user"})," Top Posters"),key:"2"},o.a.createElement("ul",null,function(){if(0!==c.length)return P.a.map(c.sorted,(function(e,a){return o.a.createElement("li",{key:a},e.name," ",o.a.createElement("b",null,function(e){return e.count>1?"".concat(e.count," posts"):"".concat(e.count," post")}(e)))}))}())),o.a.createElement(le,{header:o.a.createElement("span",null,o.a.createElement(C.a,{type:"pushpin"})," Created by"),key:"3"},o.a.createElement("div",null,o.a.createElement("p",null,o.a.createElement("img",{src:a.createdBy.avatar,alt:"Dev Chat Image"})," ",o.a.createElement("b",null,a.createdBy.name)," "))))))),e}())},ie=(t(347),function(){return o.a.createElement("div",{className:"lds-ring"},o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null),o.a.createElement("div",null))}),oe=function(e){function a(){var e,t;Object(n.a)(this,a);for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return(t=Object(c.a)(this,(e=Object(l.a)(a)).call.apply(e,[this].concat(s)))).state={firstLoading:!0},t}return Object(s.a)(a,e),Object(r.a)(a,[{key:"render",value:function(){return this.props.currentUser?o.a.createElement("div",{className:"chat-wrapper"},o.a.createElement(q,{user:this.props.currentUser,channel:this.props.currentChannel,key:this.props.currentUser}),o.a.createElement(re,{user:this.props.currentUser,channel:this.props.currentChannel,channelType:this.props.channelType,key:Math.random()}),o.a.createElement(se,{user:this.props.currentUser,channel:this.props.currentChannel,channelType:this.props.channelType,key:Math.random()})):o.a.createElement(ie,null)}}]),a}(i.Component),ue=Object(E.b)((function(e){return{currentUser:e.user.currentUser,currentChannel:e.channel.currentChannel,channelType:e.channel.channelType}}),(function(e){return{setCurrentChannel:function(a){return e(b(a))}}}))(oe),me=t(354),de=(t(170),t(171),function(){var e,a=Object(i.useState)({email:"",password:""}),t=Object(j.a)(a,2),n=t[0],r=t[1],c=Object(i.useState)({err:[]}),l=Object(j.a)(c,2),s=l[0],u=l[1],m=Object(i.useState)({loading:!1}),d=Object(j.a)(m,2),p=d[0],h=d[1],f=function(e){r(Object(y.a)({},n,Object(S.a)({},e.target.name,e.target.value)))},g=function(e){var a=e.email,t=e.password,n="",r=[];return E(a)?b(t)?(h(Object(y.a)({},p,{loading:!0})),void V.auth().signInWithEmailAndPassword(a,t).then((function(e){h(Object(y.a)({},p,{loading:!1}))})).catch((function(e){h(Object(y.a)({},p,{loading:!1})),console.log(e),u(Object(y.a)({},s,{err:s.err.concat(e.message)}))}))):(n="Password should contain at least 6 character",u(Object(y.a)({},s,{err:r.concat(n)})),!1):(n="Please enter a valid e-mail address",u(Object(y.a)({},s,{err:r.concat(n)})),!1)},E=function(e){return!!e.match(/\S+@\S+\.\S+/)},b=function(e){return!(e.length<6)};return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"brand"},o.a.createElement("h1",null,o.a.createElement(C.a,{type:"wechat"})," Dev",o.a.createElement("span",null,"Chat"))),o.a.createElement("div",{className:"auth-wrapper"},o.a.createElement("form",{onSubmit:function(e){e.preventDefault(),g(n)&&console.log("Success")},noValidate:!0},o.a.createElement("h2",null,o.a.createElement(C.a,{type:"export"}),"Login"),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",null,"Enter your email address:"),o.a.createElement(k.a,{type:"email",name:"email",onChange:f})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",null,"Enter your password:"),o.a.createElement(k.a,{type:"password",name:"password",onChange:f})),o.a.createElement("div",{className:"show-auth-errors"},(e=s.err,P.a.map(e,(function(e,a){return o.a.createElement("p",{key:a},e)})))),o.a.createElement("div",{className:"form-group",style:{textAlign:"center"}},o.a.createElement(T.a,{htmlType:"submit",type:"primary",disabled:p.loading,loading:p.loading},"Log In")),o.a.createElement("div",{className:"auth-switch"},o.a.createElement("p",null,"You don't have an account, ",o.a.createElement(me.a,{to:"/register"},"click here"))))))}),pe=t(186),he=t.n(pe),fe=function(){var e=Object(i.useState)({name:"",email:"",password:"",passwordconfirm:""}),a=Object(j.a)(e,2),t=a[0],n=a[1],r=Object(i.useState)({err:[]}),c=Object(j.a)(r,2),l=c[0],s=c[1],u=Object(i.useState)({loading:!1}),m=Object(j.a)(u,2),d=m[0],p=m[1],h=function(e){n(Object(y.a)({},t,Object(S.a)({},e.target.name,e.target.value)))},f=function(e){return V.database().ref("users").child(e.user.uid).set({user:e.user.displayName,avatar:e.user.photoURL,id:e.user.uid})},g=function(e){var a="",t=[];return E()?(a="All fields are required",s(Object(y.a)({},t,{err:t.concat(a)})),!1):b()?v()?!!O()||(a="Passwords do not match",s(Object(y.a)({},t,{err:t.concat(a)})),!1):(a="Password should contain at least 6 character",s(Object(y.a)({},t,{err:t.concat(a)})),!1):(a="Please enter a valid e-mail address",s(Object(y.a)({},t,{err:t.concat(a)})),!1)},E=function(){return!t.name.length||!t.email.length||!t.password.length||!t.passwordconfirm.length},b=function(){return!!t.email.match(/\S+@\S+\.\S+/)},v=function(){return!((t.password.length||t.passwordconfirm.length)<6)},O=function(){return t.password===t.passwordconfirm},N=function(e){return P.a.some(l.err,(function(a){return a.includes(e)}))?"not-valid":""};return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"brand"},o.a.createElement("h1",null," ",o.a.createElement(C.a,{type:"wechat"})," Dev",o.a.createElement("span",null,"Chat"))),o.a.createElement("div",{className:"auth-wrapper"},o.a.createElement("form",{onSubmit:function(e){e.preventDefault(),g(t)&&(p(Object(y.a)({},d,{loading:!0})),s({err:[]}),V.auth().createUserWithEmailAndPassword(t.email,t.password).then((function(e){p(Object(y.a)({},d,{loading:!0})),e.user.updateProfile({displayName:t.name,photoURL:"http://gravatar.com/avatar/".concat(he()(e.user.email),"?d=identicon")}).then((function(){f(e)})).catch((function(e){console.log(e),p(Object(y.a)({},d,{loading:!1}))}))})).catch((function(e){console.log(e),p(Object(y.a)({},d,{loading:!1}))})))},noValidate:!0},o.a.createElement("h2",null,o.a.createElement(C.a,{type:"export"}),"Register"),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",null,"Enter your name:"),o.a.createElement(k.a,{type:"text",name:"name",value:t.name,onChange:h})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",null,"Enter your email address:"),o.a.createElement(k.a,{type:"email",name:"email",value:t.email,onChange:h,className:N("e-mail")})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",null,"Enter your password:"),o.a.createElement(k.a,{type:"password",name:"password",value:t.password,onChange:h,className:N("password")})),o.a.createElement("div",{className:"form-group"},o.a.createElement("label",null,"Confirm password:"),o.a.createElement(k.a,{type:"password",name:"passwordconfirm",value:t.passwordconfirm,onChange:h,className:N("password")})),o.a.createElement("div",{className:"show-auth-errors"},P.a.map(l.err,(function(e,a){return o.a.createElement("p",{key:a},e)}))),o.a.createElement("div",{className:"form-group",style:{textAlign:"center"}},o.a.createElement(T.a,{htmlType:"submit",type:"primary",disabled:d.loading,loading:d.loading},"Register")),o.a.createElement("div",{className:"auth-switch"},o.a.createElement("p",null,"You already have an account, ",o.a.createElement(me.a,{to:"/login"},"click here"))))))},ge=t(62),Ee=t(187),be={currentUser:null,isLoading:!0},ve={currentChannel:null},ye=Object(ge.combineReducers)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:be,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"SET_USER":return{currentUser:a.payload.currentUser,isLoading:!1};case"CLEAR_USER":return Object(y.a)({},e,{isLoading:!1});default:return e}},channel:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"SET_CURRENT_CHANNEL":return Object(y.a)({},e,{currentChannel:a.payload.currentChannel});case"SET_CHANNEL_TYPE":return Object(y.a)({},e,{channelType:a.payload});default:return e}}}),je=Object(ge.createStore)(ye,Object(Ee.composeWithDevTools)()),Oe=function(e){function a(){return Object(n.a)(this,a),Object(c.a)(this,Object(l.a)(a).apply(this,arguments))}return Object(s.a)(a,e),Object(r.a)(a,[{key:"componentDidMount",value:function(){var e=this;V.auth().onAuthStateChanged((function(a){a?(e.props.setUser(a),e.props.history.push("/")):e.props.history.push("/login")}))}},{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(d.a,null,o.a.createElement(p.a,{exact:!0,path:"/",component:ue}),o.a.createElement(p.a,{path:"/login",component:de}),o.a.createElement(p.a,{path:"/register",component:fe}),o.a.createElement(h.a,{to:"/"})))}}]),a}(i.Component),Ce=Object(f.a)(Object(E.b)((function(e){return{isLoading:e.isLoading}}),(function(e){return{setUser:function(a){return e(function(e){return{type:"SET_USER",payload:{currentUser:e}}}(a))}}}))(Oe));m.a.render(o.a.createElement(E.a,{store:je},o.a.createElement(g.a,null,o.a.createElement(Ce,null))),document.getElementById("root"))}},[[193,1,2]]]);
//# sourceMappingURL=main.d09437cd.chunk.js.map